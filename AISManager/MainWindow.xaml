<?xml version="1.0" encoding="UTF-8"?>
<Window x:Class="AISManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AISManager"
        mc:Ignorable="d"
        Title="AIS Update Manager"
        Icon="app_icon.ico"
        Height="700"
        Width="950"
        MinWidth="950"
        MinHeight="700"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource WindowGradient}"
        Closing="Window_Closing"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True"
        TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType">
    <Window.Resources>
        <!-- MODERN PALETTE -->
        <SolidColorBrush x:Key="PrimaryBlue" Color="#3B82F6" />
        <SolidColorBrush x:Key="PrimaryBlueHover" Color="#2563EB" />
        <LinearGradientBrush x:Key="SidebarGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#1E293B" Offset="0" />
            <GradientStop Color="#0F172A" Offset="0.5" />
            <GradientStop Color="#020617" Offset="1" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="SidebarItemHover" Color="#334155" />
        <SolidColorBrush x:Key="SidebarItemActive" Color="#3B82F6" />
        <SolidColorBrush x:Key="SidebarText" Color="#94A3B8" />
        <SolidColorBrush x:Key="SidebarTextActive" Color="#FFFFFF" />
        <LinearGradientBrush x:Key="WindowGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FFFFFF" Offset="0" />
            <GradientStop Color="#E0E7FF" Offset="0.5" />
            <GradientStop Color="#F3E8FF" Offset="1" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="WindowBg" Color="#F8FAFC" />
        <SolidColorBrush x:Key="BorderLight" Color="#E2E8F0" />
        <SolidColorBrush x:Key="TextDark" Color="#1E293B" />
        <SolidColorBrush x:Key="TextMuted" Color="#475569" />
        
        <DropShadowEffect x:Key="CardShadow" BlurRadius="25" ShadowDepth="5" Color="#000000" Opacity="0.12"/>
        <DropShadowEffect x:Key="ButtonShadow" BlurRadius="10" ShadowDepth="2" Color="#3B82F6" Opacity="0.2"/>

        <SolidColorBrush x:Key="GridZebra" Color="#F8FAFC" />
        <SolidColorBrush x:Key="GridBorder" Color="#E2E8F0" />
        
        <!-- ICON GEOMETRIES -->
        <Geometry x:Key="IconBox">M21 16.5C21 16.88 20.79 17.21 20.47 17.38L12.57 21.82C12.41 21.94 12.21 22 12 22C11.79 22 11.59 21.94 11.43 21.82L3.53 17.38C3.21 17.21 3 16.88 3 16.5V7.5C3 7.12 3.21 6.79 3.53 6.62L11.43 2.18C11.59 2.06 11.79 2 12 2C12.21 2 12.41 2.06 12.57 2.18L20.47 6.62C20.79 6.79 21 7.12 21 7.5V16.5M12 4.15L6.04 7.5L12 10.85L17.96 7.5L12 4.15M5 15.91L11 19.29V12.58L5 9.21V15.91M19 15.91V9.21L13 12.58V19.29L19 15.91Z</Geometry>
        <Geometry x:Key="IconDisc">M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,16.5A4.5,4.5 0 0,1 7.5,12A4.5,4.5 0 0,1 12,7.5A4.5,4.5 0 0,1 16.5,12A4.5,4.5 0 0,1 12,16.5M12,10.5A1.5,1.5 0 0,0 10.5,12A1.5,1.5 0 0,0 12,13.5A1.5,1.5 0 0,0 13.5,12A1.5,1.5 0 0,0 12,10.5Z</Geometry>
        <Geometry x:Key="IconSettings">M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.97 19.05,5.05L16.56,6.05C16.04,5.65 15.47,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.53,5.32 7.96,5.65 7.44,6.05L4.95,5.05C4.73,4.97 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.95C7.96,18.35 8.53,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.47,18.68 16.03,18.35 16.56,17.95L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z</Geometry>
        <Geometry x:Key="IconRefresh">M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z</Geometry>
        <Geometry x:Key="IconLogs">M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M7,7H17V5H19V19H5V5H7V7M12,11L11,15L15,8L12,5L8,12L12,11.5L13,11Z</Geometry>
        <Geometry x:Key="IconDownload">M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z</Geometry>
        <Geometry x:Key="IconClose">M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z</Geometry>
        <Geometry x:Key="IconInfo">M11,9H13V7H11V9M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z</Geometry>

        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <local:InverseBooleanToVisibilityConverter x:Key="InvBoolToVis" />
        <local:BooleanToOpacityConverter x:Key="BoolToOpacity" />
        <local:NullToVisibilityConverter x:Key="NullToVis" />
        
        <!-- Стили кнопок -->
        <Style x:Key="MenuButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{StaticResource SidebarText}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="Padding" Value="14,12" />
            <Setter Property="Margin" Value="10,4" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}"
                                CornerRadius="10"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter Grid.ColumnSpan="2" VerticalAlignment="Center" />
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="Background.Color" To="#2D3A4F" Duration="0:0:0.2"/>
                                            <ColorAnimation Storyboard.TargetProperty="Foreground.Color" To="#FFFFFF" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="Background.Color" Duration="0:0:0.2"/>
                                            <ColorAnimation Storyboard.TargetProperty="Foreground.Color" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="ActiveMenuButtonStyle" TargetType="Button" BasedOn="{StaticResource MenuButtonStyle}">
            <Setter Property="Background" Value="{StaticResource SidebarItemActive}" />
            <Setter Property="Foreground" Value="{StaticResource SidebarTextActive}" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}"
                                CornerRadius="10"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="True">
                            <Grid>
                                <Border HorizontalAlignment="Left" Width="4" Height="20" Background="White" CornerRadius="2" Margin="-12,0,0,0"/>
                                <ContentPresenter VerticalAlignment="Center" />
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="0" Color="#3B82F6" Opacity="0.5"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryBlue}" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Padding" Value="24,12" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Effect" Value="{StaticResource ButtonShadow}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="12"
                                SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border" 
                                                            Storyboard.TargetProperty="Background.Color" 
                                                            To="#2563EB" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border" 
                                                            Storyboard.TargetProperty="Background.Color" 
                                                            Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#E2E8F0" />
                    <Setter Property="Foreground" Value="#94A3B8" />
                    <Setter Property="Effect" Value="{x:Null}" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Кастомный Скроллбар -->
        <Style TargetType="{x:Type ScrollBar}">
            <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false" />
            <Setter Property="Stylus.IsFlicksEnabled" Value="false" />
            <Setter Property="Width" Value="6" />
            <Setter Property="Margin" Value="4,0,0,0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="Bg" Background="Transparent" SnapsToDevicePixels="true">
                            <Track x:Name="PART_Track" IsDirectionReversed="true" IsEnabled="{TemplateBinding IsMouseOver}">
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="{x:Type Thumb}">
                                                <Border Background="#CBD5E0" CornerRadius="3" />
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="{x:Type ScrollViewer}">
            <Setter Property="Padding" Value="0,0,10,0" />
        </Style>

        <Style x:Key="LogHandleButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource BorderLight}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="6,6,0,0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#CBD5E0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="10,8" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderLight}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Foreground" Value="{StaticResource TextDark}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ScrollViewer x:Name="PART_ContentHost" Focusable="false" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="BorderBrush.Color" To="#3B82F6" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="BorderBrush.Color" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="CheckBox">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Foreground" Value="{StaticResource TextDark}" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Margin" Value="0,4" />
        </Style>

        <Geometry x:Key="IconFolder">M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z</Geometry>
        <Geometry x:Key="IconFlash">M7,2V13H10V22L17,10H13L17,2H7Z</Geometry>
        <Geometry x:Key="IconOpenOutside">M14,3V5H17.59L7,15.59L8.41,17L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z</Geometry>

        <!-- АНИМАЦИИ ВЫЕЗДА ЛОГА -->
        <Storyboard x:Key="LogOpacityIn">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.3"/>
        </Storyboard>
        <Storyboard x:Key="LogOpacityOut">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.2"/>
        </Storyboard>
        
        <Storyboard x:Key="LogHeightIn">
            <DoubleAnimation Storyboard.TargetProperty="MaxHeight" To="400" Duration="0:0:0.4">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Storyboard x:Key="LogHeightOut">
            <DoubleAnimation Storyboard.TargetProperty="MaxHeight" To="0" Duration="0:0:0.4">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Style TargetType="ProgressBar">
            <Setter Property="Height" Value="4" />
            <Setter Property="Foreground" Value="{StaticResource PrimaryBlue}" />
            <Setter Property="Background" Value="#E2E8F0" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="SnapsToDevicePixels" Value="True" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Grid x:Name="TemplateRoot">
                            <Border Background="{TemplateBinding Background}" CornerRadius="2" />
                            <Border x:Name="PART_Track" ClipToBounds="True" CornerRadius="2">
                                <Rectangle x:Name="PART_Indicator" 
                                           HorizontalAlignment="Left" 
                                           Fill="{TemplateBinding Foreground}" />
                            </Border>
                            
                            <!-- Слой для анимации ожидания -->
                            <Border x:Name="IndeterminateRoot" Visibility="Collapsed" ClipToBounds="True" CornerRadius="2">
                                <Rectangle x:Name="IndeterminatePart" Width="300" HorizontalAlignment="Left" VerticalAlignment="Stretch">
                                    <Rectangle.Fill>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                            <GradientStop Color="#00FFFFFF" Offset="0" />
                                            <GradientStop Color="#60FFFFFF" Offset="0.5" />
                                            <GradientStop Color="#00FFFFFF" Offset="1" />
                                        </LinearGradientBrush>
                                    </Rectangle.Fill>
                                    <Rectangle.RenderTransform>
                                        <TranslateTransform x:Name="IndeterminateTranslate" X="-300" />
                                    </Rectangle.RenderTransform>
                                </Rectangle>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsIndeterminate" Value="True">
                                <Setter TargetName="IndeterminateRoot" Property="Visibility" Value="Visible" />
                                <Setter TargetName="PART_Indicator" Property="Visibility" Value="Collapsed" />
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimation Storyboard.TargetName="IndeterminateTranslate"
                                                             Storyboard.TargetProperty="X"
                                                             From="-300" To="1400"
                                                             Duration="0:0:1.5" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="240" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <!-- САЙДБАР -->
        <Border Grid.Column="0"
                Background="{StaticResource SidebarGradient}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                
                <StackPanel Grid.Row="0" Margin="25,45,10,35">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="1" Margin="15,0,0,0" VerticalAlignment="Center">
                            <TextBlock Text="DASHBOARD" Foreground="White" FontWeight="Black" FontSize="15" />
                            <TextBlock Text="Automated Update" Foreground="{StaticResource SidebarText}" FontSize="10" FontWeight="Medium" Margin="0,2,0,0"/>
                            <Border Background="#EF4444" 
                                    HorizontalAlignment="Left" 
                                    Padding="8,3" 
                                    CornerRadius="5" 
                                    Margin="0,8,0,0">
                                <TextBlock Text="RELEASE PROTOTYPE" 
                                           Foreground="White" 
                                           FontSize="10" 
                                           FontWeight="ExtraBold"
                                           TextOptions.TextFormattingMode="Display"
                                           TextOptions.TextRenderingMode="ClearType" />
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="10" Color="#EF4444" Opacity="0.4" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </StackPanel>
                    </Grid>
                </StackPanel>

                <StackPanel Grid.Row="1" Margin="0,10,0,0">
                    <Button x:Name="BtnFixes"
                            Style="{StaticResource ActiveMenuButtonStyle}"
                            Click="MenuButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <Path Data="{StaticResource IconBox}" 
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" 
                                  Width="18" Height="18" Stretch="Uniform" Margin="0,0,10,0"/>
                            <TextBlock Text="Пакеты исправлений" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                    
                    <Grid>
                        <Button x:Name="BtnDistros"
                                Style="{StaticResource MenuButtonStyle}"
                                Click="MenuButton_Click">
                            <StackPanel Orientation="Horizontal">
                                <Path Data="{StaticResource IconDisc}" 
                                      Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" 
                                      Width="18" Height="18" Stretch="Uniform" Margin="0,0,10,0"/>
                                <TextBlock Text="Дистрибутивы ПО" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Border Background="#10B981" 
                                Width="6" 
                                Height="6" 
                                CornerRadius="3" 
                                HorizontalAlignment="Right" 
                                VerticalAlignment="Center" 
                                Margin="0,0,25,0"
                                IsHitTestVisible="False"
                                Visibility="{Binding HasNewDistroNotification, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="6" ShadowDepth="0" Color="#10B981" Opacity="0.5"/>
                            </Border.Effect>
                        </Border>
                    </Grid>

                    <Button x:Name="BtnSettings"
                            Style="{StaticResource MenuButtonStyle}"
                            Click="MenuButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <Path Data="{StaticResource IconSettings}" 
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" 
                                  Width="18" Height="18" Stretch="Uniform" Margin="0,0,10,0"/>
                            <TextBlock Text="Настройки" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button x:Name="BtnAbout"
                            Style="{StaticResource MenuButtonStyle}"
                            Click="MenuButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <Path Data="{StaticResource IconInfo}" 
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" 
                                  Width="18" Height="18" Stretch="Uniform" Margin="0,0,10,0"/>
                            <TextBlock Text="О программе" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <TextBlock Grid.Row="2" 
                           Text="v 0.8.0" 
                           Foreground="{StaticResource SidebarText}" 
                           FontSize="10" 
                           Margin="25,20" 
                           Opacity="0.6"
                           VerticalAlignment="Bottom"/>
            </Grid>
        </Border>
        <!-- КОНТЕНТ -->
        <Grid Grid.Column="1" VerticalAlignment="Stretch">
            <Grid.RowDefinitions>
                <RowDefinition Height="80" /> <!-- Шапка -->
                <RowDefinition Height="*" MinHeight="200" /> <!-- Контент -->
                <RowDefinition x:Name="SplitterRow" Height="Auto">
                    <RowDefinition.Style>
                        <Style TargetType="RowDefinition">
                            <Setter Property="MaxHeight" Value="Infinity" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsLogVisible}" Value="False">
                                    <Setter Property="MaxHeight" Value="0" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </RowDefinition.Style>
                </RowDefinition>
                <RowDefinition x:Name="LogRow" Height="Auto">
                    <RowDefinition.Style>
                        <Style TargetType="RowDefinition">
                            <Setter Property="MaxHeight" Value="Infinity" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsLogVisible}" Value="False">
                                    <Setter Property="MaxHeight" Value="0" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </RowDefinition.Style>
                </RowDefinition>
            </Grid.RowDefinitions>
            <!-- ШАПКА -->
            <Border Grid.Row="0"
                    Background="#F2FFFFFF"
                    BorderBrush="{StaticResource BorderLight}"
                    BorderThickness="0,0,0,1"
                    Effect="{StaticResource CardShadow}">
                <Grid Margin="30,0">
                    <StackPanel VerticalAlignment="Center"
                                HorizontalAlignment="Left">
                        <TextBlock Text="ТЕКУЩАЯ ВЕРСИЯ АИС НАЛОГ 3 ПРОМ"
                                   Foreground="{StaticResource TextMuted}"
                                   FontSize="10"
                                   FontWeight="Bold" 
                                  />
                        <TextBlock Text="{Binding CurrentVersion}"
                                   Foreground="{StaticResource TextDark}"
                                   FontWeight="Bold"
                                   FontSize="20"
                                   Margin="0,4,0,0" />
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center">
                        
                        <Border Background="{Binding AutoCheckStatusColor}" 
                                Width="8" Height="8" CornerRadius="4" Margin="0,0,12,0"/>
                        
                        <StackPanel VerticalAlignment="Center" Margin="0,0,25,0">
                            <TextBlock Text="{Binding AutoCheckStatusText}"
                                       Foreground="{Binding AutoCheckStatusColor}"
                                       FontSize="11"
                                       FontWeight="Bold" />
                            <TextBlock Text="{Binding LastCheckTimeText}"
                                       Foreground="{StaticResource TextMuted}"
                                       FontSize="10" />
                        </StackPanel>

                        <Rectangle Width="1" Height="30" Fill="{StaticResource BorderLight}" Margin="0,0,15,0"/>

                        <Button Command="{Binding ToggleLogCommand}"
                                Width="40" Height="40"
                                Background="Transparent"
                                BorderThickness="0"
                                ToolTip="Показать/скрыть логи"
                                Cursor="Hand">
                            <Grid>
                                <Path Data="{StaticResource IconLogs}" 
                                      Fill="{StaticResource TextDark}"
                                      Width="18" Height="18" Stretch="Uniform"
                                      Opacity="{Binding IsLogVisible, Converter={StaticResource BoolToOpacity}, ConverterParameter=0.5}"/>
                                <Border Width="10" Height="10" 
                                         Background="#EF4444" 
                                         CornerRadius="5"
                                         VerticalAlignment="Top" 
                                         HorizontalAlignment="Right" 
                                         Margin="0,2,2,0"
                                         Visibility="{Binding HasUnreadLogs, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="4" Color="#EF4444" Opacity="0.4" ShadowDepth="0"/>
                                    </Border.Effect>
                                </Border>
                            </Grid>
                        </Button>

                        <Button Command="{Binding CheckUpdatesCommand}"
                                Width="40" Height="40"
                                Margin="8,0,0,0"
                                Background="Transparent"
                                BorderThickness="0"
                                ToolTip="Проверить обновления"
                                Cursor="Hand">
                            <Path Data="{StaticResource IconRefresh}" 
                                  Fill="{StaticResource TextDark}"
                                  Width="18" Height="18" Stretch="Uniform"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>
            <!-- ГЛАВНАЯ ОБЛАСТЬ (ТЕПЕРЬ НА ВЕСЬ ЭКРАН) -->
            <Grid Grid.Row="1" Margin="30,20" VerticalAlignment="Stretch">
                <!-- VIEW: FIXES (COMPACT ENTERPRISE GRID) -->
                <Grid x:Name="ViewFixes" VerticalAlignment="Stretch" Visibility="Visible">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- ЗАГОЛОВОК -->
                    <Grid Grid.Row="0" Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Список обновлений"
                                   FontSize="16"
                                   FontWeight="Bold"
                                   Foreground="{StaticResource TextDark}" />
                        <CheckBox Grid.Column="1" 
                                  Content="Выбрать все" 
                                  IsChecked="{Binding IsAllSelected}"
                                  VerticalAlignment="Center"
                                  FontWeight="SemiBold"
                                  Foreground="{StaticResource TextMuted}"/>
                    </Grid>

                    <!-- ТАБЛИЦА (СПИСОК) -->
                    <Border Grid.Row="1" 
                            Background="#A6FFFFFF" 
                            BorderBrush="{StaticResource GridBorder}" 
                            BorderThickness="1" 
                            CornerRadius="12"
                            ClipToBounds="True">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <!-- ОБЩИЙ ПРОГРЕСС СВЕРХУ (ВНУТРИ КАРТОЧКИ) -->
                            <ProgressBar Grid.Row="0" 
                                         Value="{Binding TotalFixesProgress}" 
                                         IsIndeterminate="{Binding IsFixesIndeterminate}"
                                         Visibility="{Binding IsFixesBusy, Converter={StaticResource BooleanToVisibilityConverter}}"
                                         Height="3" 
                                         Background="Transparent" 
                                         BorderThickness="0" 
                                         Foreground="{StaticResource PrimaryBlue}"/>

                            <ListView Grid.Row="1"
                                      ItemsSource="{Binding Updates}"
                                      BorderThickness="0"
                                      Background="Transparent"
                                      Padding="0"
                                      VerticalAlignment="Stretch"
                                      ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                    <Setter Property="Padding" Value="0"/>
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="ListViewItem">
                                                <Border x:Name="rowBorder" 
                                                        BorderBrush="{StaticResource GridBorder}"
                                                        BorderThickness="0,0,0,1"
                                                        Padding="15,10">
                                                    <ContentPresenter />
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                                                        <Setter TargetName="rowBorder" Property="Background" Value="{StaticResource GridZebra}"/>
                                                    </Trigger>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="rowBorder" Property="Background" Value="#EFF6FF"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.AlternationCount>2</ListView.AlternationCount>
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="150" />
                                            <ColumnDefinition Width="110" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox IsChecked="{Binding IsSelected}"
                                                  VerticalAlignment="Center" 
                                                  HorizontalAlignment="Center"/>
                                        
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="10,0">
                                            <TextBlock Text="{Binding FileName}"
                                                       FontWeight="SemiBold"
                                                       FontSize="13"
                                                       Foreground="{StaticResource TextDark}" />
                                            <TextBlock Text="{Binding Size}"
                                                       FontSize="11"
                                                       Foreground="{StaticResource TextMuted}" 
                                                       Margin="12,0,0,0"
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>
                                        
                                        <Grid Grid.Column="2" VerticalAlignment="Center" Margin="15,0">
                                            <ProgressBar Value="{Binding ProgressValue}"
                                                         Maximum="100"
                                                         Height="4"
                                                         VerticalAlignment="Center"
                                                         Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                        </Grid>
                                        
                                        <Border Grid.Column="3"
                                                Background="{Binding StatusBgColor}"
                                                CornerRadius="4"
                                                Padding="8,3"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Center">
                                            <TextBlock Text="{Binding StatusText}"
                                                       FontSize="10"
                                                       Foreground="{Binding StatusFgColor}"
                                                       FontWeight="Bold" />
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </Border>

                <!-- КНОПКИ УПРАВЛЕНИЯ -->
                    <StackPanel Grid.Row="2" 
                                Orientation="Horizontal" 
                                HorizontalAlignment="Right" 
                                Margin="0,15,0,0">
                        
                        <Button x:Name="BtnCancelFixes"
                                Command="{Binding CancelDownloadFixesCommand}"
                                Visibility="{Binding IsFixesBusy, Converter={StaticResource BooleanToVisibilityConverter}}"
                                Margin="0,0,12,0"
                                Padding="15,8" 
                                Background="#FEF2F2" 
                                Foreground="#EF4444" 
                                BorderBrush="#FEE2E2"
                                BorderThickness="1"
                                Height="36">
                             <Button.Resources>
                                <Style TargetType="Border"><Setter Property="CornerRadius" Value="6"/></Style>
                            </Button.Resources>
                            <StackPanel Orientation="Horizontal">
                                <Path Data="{StaticResource IconClose}" Fill="#EF4444" Width="12" Height="12" Stretch="Uniform" Margin="0,0,8,0"/>
                                <TextBlock Text="{Binding CancelActionText}" FontSize="12" FontWeight="SemiBold" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>

                        <Button x:Name="BtnProcess"
                                Style="{StaticResource PrimaryButtonStyle}"
                                Command="{Binding DownloadCommand}"
                                Visibility="{Binding IsFixesBusy, Converter={StaticResource InvBoolToVis}}"
                                Height="38"
                                Padding="20,0"
                                Width="250">
                            <StackPanel Orientation="Horizontal">
                                <Path Data="{StaticResource IconDownload}" Fill="White" Width="14" Height="14" Stretch="Uniform" Margin="0,0,10,0"/>
                                <TextBlock Text="СФОРМИРОВАТЬ СБОРКУ FIX" FontSize="12" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Grid>
                <!-- VIEW: DISTROS -->
                <Grid x:Name="ViewDistros" Visibility="Collapsed" VerticalAlignment="Stretch">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Дистрибутивы ПО (FTP)" FontSize="16" FontWeight="Bold" Foreground="{StaticResource TextDark}" Margin="0,0,0,20"/>
                    
                    <ScrollViewer Grid.Row="1">
                        <StackPanel>
                            <!-- ГРУППА OE -->

                            <Border Background="White" 
                                    BorderBrush="{StaticResource BorderLight}" 
                                    BorderThickness="1" 
                                    CornerRadius="16" 
                                    Padding="25" 
                                    Margin="0,0,0,25" 
                                    Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <StackPanel>
                                            <TextBlock Text="ПОСЛЕДНЯЯ ВЕРСИЯ OE" Foreground="{StaticResource TextMuted}" FontSize="10" FontWeight="Bold"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                                <TextBlock Text="{Binding LatestDistro.Version, FallbackValue='Не проверено'}" Foreground="{StaticResource TextDark}" FontWeight="Bold" FontSize="22"/>
                                                <Ellipse Width="8" Height="8" Fill="#10B981" Margin="10,0,0,0" VerticalAlignment="Center" 
                                                         Visibility="{Binding LatestDistro.IsDownloaded, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <Ellipse.Effect>
                                                        <DropShadowEffect BlurRadius="10" Color="#10B981" Opacity="0.6" ShadowDepth="0"/>
                                                    </Ellipse.Effect>
                                                </Ellipse>
                                            </StackPanel>
                                            <TextBlock Text="{Binding LatestDistro.FileName}" Foreground="{StaticResource TextMuted}" FontSize="11" Margin="0,4,0,0"/>
                                        </StackPanel>
                                        <Button Grid.Column="1" Command="{Binding CheckDistrosCommand}" 
                                                Padding="15,8" Background="#F1F5F9" BorderThickness="0" Cursor="Hand" VerticalAlignment="Top">
                                            <Button.Resources>
                                                <Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style>
                                            </Button.Resources>
                                            <StackPanel Orientation="Horizontal">
                                                <Path Data="{StaticResource IconRefresh}" Fill="{StaticResource TextDark}" Width="14" Height="14" Stretch="Uniform" Margin="0,0,8,0"/>
                                                <TextBlock Text="Обновить" FontWeight="SemiBold" FontSize="12"/>
                                            </StackPanel>
                                        </Button>
                                    </Grid>
                                    
                                    <Separator Margin="0,20" Background="{StaticResource BorderLight}"/>
                                    
                                    <StackPanel Visibility="{Binding LatestDistro, Converter={StaticResource NullToVis}}">
                                        <TextBlock Text="Статус:" Foreground="{StaticResource TextMuted}" FontSize="12"/>
                                        <TextBlock Text="{Binding LatestDistro.DownloadStatus}" Foreground="{StaticResource TextDark}" FontWeight="SemiBold" Margin="0,5,0,0"/>
                                        
                                        <TextBlock Text="{Binding LatestDistro.ProgressText}" HorizontalAlignment="Right" FontSize="11" Margin="0,15,0,0" Visibility="{Binding LatestDistro.IsDownloading, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <ProgressBar Value="{Binding LatestDistro.Progress}" Foreground="{StaticResource PrimaryBlue}"
                                                      IsIndeterminate="{Binding LatestDistro.IsIndeterminate}"
                                                      Maximum="100" Height="8" Margin="0,5,0,5" 
                                                      Visibility="{Binding LatestDistro.IsDownloading, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                        <StackPanel Orientation="Horizontal" Margin="0,15,0,0">
                                            <Button Style="{StaticResource PrimaryButtonStyle}" 
                                                    Command="{Binding DownloadDistroCommand}" 
                                                    Visibility="{Binding LatestDistro.IsDownloading, Converter={StaticResource InvBoolToVis}}"
                                                    Padding="20,10">
                                                <StackPanel Orientation="Horizontal">
                                                    <Path Data="{StaticResource IconDownload}" Fill="White" Width="16" Height="16" Stretch="Uniform" Margin="0,0,10,0"/>
                                                    <TextBlock Text="Скачать OE (.rar)" VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Command="{Binding DataContext.CancelDownloadOeCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    Visibility="{Binding LatestDistro.IsDownloading, Converter={StaticResource BooleanToVisibilityConverter}}"
                                                    Padding="18,10" Background="#FEF2F2" Foreground="#EF4444" BorderThickness="0">
                                                <Button.Resources>
                                                    <Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style>
                                                </Button.Resources>
                                                <StackPanel Orientation="Horizontal">
                                                    <Path Data="{StaticResource IconClose}" Fill="#EF4444" Width="14" Height="14" Stretch="Uniform" Margin="0,0,10,0"/>
                                                    <TextBlock Text="Отменить загрузку" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- ГРУППА PROM -->
                            <Border Background="White" 
                                    BorderBrush="{StaticResource BorderLight}" 
                                    BorderThickness="1" 
                                    CornerRadius="16" 
                                    Padding="25" 
                                    Margin="0,0,0,25"
                                    Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <StackPanel>
                                            <TextBlock Text="ПОСЛЕДНЯЯ ВЕРСИЯ ПРОМ" Foreground="{StaticResource TextMuted}" FontSize="10" FontWeight="Bold"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                                <TextBlock Text="{Binding LatestAisProm.Version, FallbackValue='Не проверено'}" Foreground="{StaticResource TextDark}" FontWeight="Bold" FontSize="22"/>
                                                <Ellipse Width="8" Height="8" Fill="#10B981" Margin="10,0,0,0" VerticalAlignment="Center" 
                                                         Visibility="{Binding LatestAisProm.IsDownloaded, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                    <Ellipse.Effect>
                                                        <DropShadowEffect BlurRadius="10" Color="#10B981" Opacity="0.6" ShadowDepth="0"/>
                                                    </Ellipse.Effect>
                                                </Ellipse>
                                            </StackPanel>
                                            <TextBlock Text="{Binding LatestAisProm.FileName}" Foreground="{StaticResource TextMuted}" FontSize="11" Margin="0,4,0,0"/>
                                        </StackPanel>
                                        <Button Grid.Column="1" Command="{Binding CheckAisPromCommand}" 
                                                Padding="15,8" Background="#F1F5F9" BorderThickness="0" Cursor="Hand" VerticalAlignment="Top">
                                            <Button.Resources>
                                                <Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style>
                                            </Button.Resources>
                                            <StackPanel Orientation="Horizontal">
                                                <Path Data="{StaticResource IconRefresh}" Fill="{StaticResource TextDark}" Width="14" Height="14" Stretch="Uniform" Margin="0,0,8,0"/>
                                                <TextBlock Text="Обновить" FontWeight="SemiBold" FontSize="12"/>
                                            </StackPanel>
                                        </Button>
                                    </Grid>
                                    
                                    <Separator Margin="0,20" Background="{StaticResource BorderLight}"/>
                                    
                                    <StackPanel Visibility="{Binding LatestAisProm, Converter={StaticResource NullToVis}}">
                                        <TextBlock Text="Статус:" Foreground="{StaticResource TextMuted}" FontSize="12"/>
                                        <TextBlock Text="{Binding LatestAisProm.DownloadStatus}" Foreground="{StaticResource TextDark}" FontWeight="SemiBold" Margin="0,5,0,0"/>
                                        
                                        <TextBlock Text="{Binding LatestAisProm.ProgressText}" HorizontalAlignment="Right" FontSize="11" Margin="0,15,0,0" Visibility="{Binding LatestAisProm.IsDownloading, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        <ProgressBar Value="{Binding LatestAisProm.Progress}" Foreground="{StaticResource PrimaryBlue}" IsIndeterminate="{Binding LatestAisProm.IsIndeterminate}" Maximum="100" Height="8" Margin="0,5,0,5" 
                                                     Visibility="{Binding LatestAisProm.IsDownloading, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,15,0,0">
                                            <Button Style="{StaticResource PrimaryButtonStyle}" 
                                                    Command="{Binding DownloadAisPromCommand}" 
                                                    Visibility="{Binding LatestAisProm.IsDownloading, Converter={StaticResource InvBoolToVis}}"
                                                    Padding="20,10">
                                                <StackPanel Orientation="Horizontal">
                                                    <Path Data="{StaticResource IconDownload}" Fill="White" Width="16" Height="16" Stretch="Uniform" Margin="0,0,10,0"/>
                                                    <TextBlock Text="Скачать Пром (.rar)" VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                            
                                            <Button Command="{Binding DataContext.CancelDownloadPromCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    Visibility="{Binding LatestAisProm.IsDownloading, Converter={StaticResource BooleanToVisibilityConverter}}"
                                                    Padding="18,10" Background="#FEF2F2" Foreground="#EF4444" BorderThickness="0">
                                                <Button.Resources>
                                                    <Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style>
                                                </Button.Resources>
                                                <StackPanel Orientation="Horizontal">
                                                    <Path Data="{StaticResource IconClose}" Fill="#EF4444" Width="14" Height="14" Stretch="Uniform" Margin="0,0,10,0"/>
                                                    <TextBlock Text="Отменить загрузку" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                    
                    <TextBlock Grid.Row="2" Text="* Дистрибутив будет скачан в папку, указанную в настройках." Foreground="{StaticResource TextMuted}" FontSize="11" Margin="0,15,0,0"/>
                </Grid>

                <!-- VIEW: SETTINGS -->
                <Grid x:Name="ViewSettings" Visibility="Collapsed">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="0,0,10,30">
                            <Grid Margin="0,10,0,25">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Настройки приложения"
                                           FontSize="22"
                                           Foreground="{StaticResource TextDark}"
                                           FontWeight="Bold" />
                                <Button Grid.Column="1" 
                                        Command="{Binding AutoSetupPathsCommand}"
                                        Padding="15,8" 
                                        Background="#F1F5F9" 
                                        BorderThickness="0" 
                                        Cursor="Hand">
                                    <Button.Resources>
                                        <Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style>
                                    </Button.Resources>
                                    <StackPanel Orientation="Horizontal">
                                        <Path Data="{StaticResource IconFlash}" Fill="{StaticResource PrimaryBlue}" Width="14" Height="14" Stretch="Uniform" Margin="0,0,10,0"/>
                                        <TextBlock Text="Авто-настройка всех путей" FontWeight="Bold" Foreground="{StaticResource PrimaryBlue}"/>
                                    </StackPanel>
                                </Button>
                            </Grid>

                            <!-- БЛОК: ПАКЕТЫ ИСПРАВЛЕНИЙ -->
                            <Border Background="White" BorderBrush="{StaticResource BorderLight}" BorderThickness="1" CornerRadius="16" Padding="25" Margin="0,0,0,25" Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                        <Path Data="{StaticResource IconBox}" Fill="{StaticResource TextDark}" Width="18" Height="18" Stretch="Uniform" Margin="0,0,12,0"/>
                                        <TextBlock Text="Автоматизация фиксов" FontSize="15" FontWeight="Bold" Foreground="{StaticResource TextDark}"/>
                                    </StackPanel>
                                    
                                    <CheckBox IsChecked="{Binding IsFullAuto}"
                                              Content="Полная автоматизация (проверка обновлений и создание SFX)" />
                                    <CheckBox IsChecked="{Binding AutoDownload}"
                                              Content="Автоматически скачивать новые фиксы"
                                              Margin="0,8,0,5" />
                                    <TextBlock Text="При нахождении новых обновлений, они будут скачаны автоматически." 
                                               FontSize="11" Foreground="{StaticResource TextMuted}" Margin="30,0,0,0"/>
                                </StackPanel>
                            </Border>

                            <!-- БЛОК: ДИСТРИБУТИВЫ -->
                            <Border Background="White" BorderBrush="{StaticResource BorderLight}" BorderThickness="1" CornerRadius="16" Padding="25" Margin="0,0,0,25" Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                        <Path Data="{StaticResource IconDisc}" Fill="{StaticResource TextDark}" Width="18" Height="18" Stretch="Uniform" Margin="0,0,12,0"/>
                                        <TextBlock Text="Автозагрузка дистрибутивов (FTP)" FontSize="15" FontWeight="Bold" Foreground="{StaticResource TextDark}"/>
                                    </StackPanel>

                                    <CheckBox IsChecked="{Binding AutoDownloadDistro}"
                                              Content="Автоматически скачивать новый дистрибутив (OE)" />
                                    
                                    <CheckBox IsChecked="{Binding AutoDownloadAisNalog3}"
                                              Content="Автоматически скачивать АИС Налог 3 (Пром)"
                                              Margin="0,8,0,5" />
                                    <TextBlock Text="Приложение будет проверять наличие новых версий на FTP и скачивать их автоматически." 
                                               FontSize="11" Foreground="{StaticResource TextMuted}" Margin="30,0,0,0"/>
                                </StackPanel>
                            </Border>

                            <!-- БЛОК: ПУТИ СОХРАНЕНИЯ -->
                            <Border Background="White" BorderBrush="{StaticResource BorderLight}" BorderThickness="1" CornerRadius="16" Padding="25" Margin="0,0,0,25" Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                        <Path Data="{StaticResource IconFolder}" Fill="{StaticResource TextDark}" Width="18" Height="18" Stretch="Uniform" Margin="0,0,12,0"/>
                                        <TextBlock Text="Пути сохранения" FontSize="15" FontWeight="Bold" Foreground="{StaticResource TextDark}"/>
                                    </StackPanel>

                                    <StackPanel Margin="0,0,0,15">
                                        <TextBlock Text="Папка выгрузки (архивы):" Foreground="{StaticResource TextMuted}" FontSize="12" Margin="0,0,0,6" />
                                        <Grid>
                                            <Grid.ColumnDefinitions><ColumnDefinition Width="*" /><ColumnDefinition Width="Auto" /></Grid.ColumnDefinitions>
                                            <TextBox Text="{Binding DownloadPath, UpdateSourceTrigger=PropertyChanged}"/>
                                            <Button Grid.Column="1" Command="{Binding SelectDownloadPathCommand}" Width="42" Margin="8,0,0,0" Background="White" BorderBrush="{StaticResource BorderLight}" BorderThickness="1">
                                                <Button.Resources><Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style></Button.Resources>
                                                <Path Data="{StaticResource IconFolder}" Fill="{StaticResource TextDark}" Width="16" Height="16" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Button>
                                        </Grid>
                                    </StackPanel>

                                    <StackPanel Margin="0,0,0,15">
                                        <TextBlock Text="Папка для SFX (архиватор):" Foreground="{StaticResource TextMuted}" FontSize="12" Margin="0,0,0,6" />
                                        <Grid>
                                            <Grid.ColumnDefinitions><ColumnDefinition Width="*" /><ColumnDefinition Width="Auto" /></Grid.ColumnDefinitions>
                                            <TextBox Text="{Binding SfxOutputPath, UpdateSourceTrigger=PropertyChanged}"/>
                                            <Button Grid.Column="1" Command="{Binding SelectSfxOutputPathCommand}" Width="42" Margin="8,0,0,0" Background="White" BorderBrush="{StaticResource BorderLight}" BorderThickness="1">
                                                <Button.Resources><Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style></Button.Resources>
                                                <Path Data="{StaticResource IconFolder}" Fill="{StaticResource TextDark}" Width="16" Height="16" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Button>
                                        </Grid>
                                    </StackPanel>

                                    <StackPanel Margin="0,0,0,15">
                                        <TextBlock Text="Папка для дистрибутивов (OE):" Foreground="{StaticResource TextMuted}" FontSize="12" Margin="0,0,0,6" />
                                        <Grid>
                                            <Grid.ColumnDefinitions><ColumnDefinition Width="*" /><ColumnDefinition Width="Auto" /></Grid.ColumnDefinitions>
                                            <TextBox Text="{Binding DistroDownloadPath, UpdateSourceTrigger=PropertyChanged}"/>
                                            <Button Grid.Column="1" Command="{Binding SelectDistroDownloadPathCommand}" Width="42" Margin="8,0,0,0" Background="White" BorderBrush="{StaticResource BorderLight}" BorderThickness="1">
                                                <Button.Resources><Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style></Button.Resources>
                                                <Path Data="{StaticResource IconFolder}" Fill="{StaticResource TextDark}" Width="16" Height="16" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Button>
                                        </Grid>
                                    </StackPanel>

                                    <StackPanel Margin="0,0,0,0">
                                        <TextBlock Text="Папка для АИС Налог 3 (Пром):" Foreground="{StaticResource TextMuted}" FontSize="12" Margin="0,0,0,6" />
                                        <Grid>
                                            <Grid.ColumnDefinitions><ColumnDefinition Width="*" /><ColumnDefinition Width="Auto" /></Grid.ColumnDefinitions>
                                            <TextBox Text="{Binding AisNalog3DownloadPath, UpdateSourceTrigger=PropertyChanged}"/>
                                            <Button Grid.Column="1" Command="{Binding SelectAisPromDownloadPathCommand}" Width="42" Margin="8,0,0,0" Background="White" BorderBrush="{StaticResource BorderLight}" BorderThickness="1">
                                                <Button.Resources><Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style></Button.Resources>
                                                <Path Data="{StaticResource IconFolder}" Fill="{StaticResource TextDark}" Width="16" Height="16" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Button>
                                        </Grid>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- БЛОК: ОТЛАДКА -->
                            <Border Background="White" BorderBrush="{StaticResource BorderLight}" BorderThickness="1" CornerRadius="16" Padding="25" Margin="0,0,0,25" Effect="{StaticResource CardShadow}">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                        <Path Data="{StaticResource IconSettings}" Fill="{StaticResource TextDark}" Width="18" Height="18" Stretch="Uniform" Margin="0,0,12,0"/>
                                        <TextBlock Text="Отладка и диагностика" FontSize="15" FontWeight="Bold" Foreground="{StaticResource TextDark}"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <Button Command="{Binding OpenAppDataCommand}" Padding="20,10" Background="#F1F5F9" BorderThickness="0" Cursor="Hand">
                                            <Button.Resources><Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style></Button.Resources>
                                            <StackPanel Orientation="Horizontal">
                                                <Path Data="{StaticResource IconOpenOutside}" Fill="{StaticResource TextDark}" Width="14" Height="14" Stretch="Uniform" Margin="0,0,12,0"/>
                                                <TextBlock Text="Открыть AppData" FontWeight="SemiBold"/>
                                            </StackPanel>
                                        </Button>

                                        <Button Command="{Binding ClearLogsCommand}" Padding="20,10" Margin="12,0,0,0" Background="#FEF2F2" Foreground="#EF4444" BorderThickness="0" Cursor="Hand">
                                            <Button.Resources><Style TargetType="Border"><Setter Property="CornerRadius" Value="8"/></Style></Button.Resources>
                                            <StackPanel Orientation="Horizontal">
                                                <Path Data="{StaticResource IconClose}" Fill="#EF4444" Width="14" Height="14" Stretch="Uniform" Margin="0,0,10,0"/>
                                                <TextBlock Text="Очистить логи" FontWeight="SemiBold"/>
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>

                <!-- VIEW: ABOUT -->
                <Grid x:Name="ViewAbout" Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="0,0,10,30">
                            <!-- HEADER CARD -->
                            <Border Background="#A6FFFFFF" BorderBrush="{StaticResource BorderLight}" BorderThickness="1" CornerRadius="24" Padding="40" Margin="0,10,0,25" Effect="{StaticResource CardShadow}">
                                <StackPanel HorizontalAlignment="Center">
                                    <Border Width="80" Height="80" Background="{StaticResource PrimaryBlue}" CornerRadius="20" HorizontalAlignment="Center" Margin="0,0,0,20">
                                        <Path Data="{StaticResource IconFlash}" Fill="White" Stretch="Uniform" Width="40" Height="40" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="30" ShadowDepth="0" Color="#3B82F6" Opacity="0.4"/>
                                        </Border.Effect>
                                    </Border>
                                    
                                    <TextBlock Text="AIS Update Manager" FontSize="28" FontWeight="Black" Foreground="{StaticResource TextDark}" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Версия 0.8.0 Release Prototype" FontSize="14" Foreground="{StaticResource TextMuted}" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                    
                                    <Border Background="#F1F5F9" CornerRadius="12" Padding="15,8" Margin="0,25,0,0" HorizontalAlignment="Center">
                                        <TextBlock Text="Инструмент для автоматизации обновлений АИС Налог 3" Foreground="{StaticResource TextDark}" FontWeight="Medium"/>
                                    </Border>
                                </StackPanel>
                            </Border>

                            <!-- INFO GRID -->
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <!-- LEFT COLUMN: AUTHOR -->
                                <Border Grid.Column="0" Grid.Row="0" Background="#A6FFFFFF" BorderBrush="{StaticResource BorderLight}" BorderThickness="1" CornerRadius="20" Padding="25" Margin="0,0,12,12" Effect="{StaticResource CardShadow}">
                                    <StackPanel>
                                        <TextBlock Text="РАЗРАБОТКА" Foreground="{StaticResource TextMuted}" FontSize="10" FontWeight="Bold" Margin="0,0,0,15"/>
                                        <StackPanel Orientation="Horizontal">
                                            <Border Width="48" Height="48" CornerRadius="24" Background="#E0E7FF">
                                                <TextBlock Text="С" Foreground="{StaticResource PrimaryBlue}" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Margin="15,0,0,0" VerticalAlignment="Center">
                                                <TextBlock Text="Саня" FontSize="18" FontWeight="Bold" Foreground="{StaticResource TextDark}"/>
                                                <TextBlock Text="Lead Developer" FontSize="12" Foreground="{StaticResource PrimaryBlue}" FontWeight="SemiBold"/>
                                            </StackPanel>
                                        </StackPanel>
                                        <TextBlock Text="Главный архитектор этого цифрового ангара. Мастер заставлять ИИ работать, пока сам пьет чай." 
                                                   TextWrapping="Wrap" FontSize="13" Foreground="{StaticResource TextMuted}" Margin="0,20,0,0" LineHeight="18"/>
                                    </StackPanel>
                                </Border>

                                <!-- RIGHT COLUMN: STATS/INFO -->
                                <Border Grid.Column="1" Grid.Row="0" Background="#A6FFFFFF" BorderBrush="{StaticResource BorderLight}" BorderThickness="1" CornerRadius="20" Padding="25" Margin="12,0,0,12" Effect="{StaticResource CardShadow}">
                                    <StackPanel>
                                        <TextBlock Text="ТЕХНОЛОГИИ" Foreground="{StaticResource TextMuted}" FontSize="10" FontWeight="Bold" Margin="0,0,0,15"/>
                                        <UniformGrid Columns="2">
                                            <StackPanel Margin="0,0,0,15">
                                                <TextBlock Text=".NET 8" FontWeight="Bold" FontSize="14" Foreground="{StaticResource TextDark}"/>
                                                <TextBlock Text="Платформа" FontSize="11" Foreground="{StaticResource TextMuted}"/>
                                            </StackPanel>
                                            <StackPanel Margin="0,0,0,15">
                                                <TextBlock Text="WPF / XAML" FontWeight="Bold" FontSize="14" Foreground="{StaticResource TextDark}"/>
                                                <TextBlock Text="Интерфейс" FontSize="11" Foreground="{StaticResource TextMuted}"/>
                                            </StackPanel>
                                            <StackPanel>
                                                <TextBlock Text="Serilog" FontWeight="Bold" FontSize="14" Foreground="{StaticResource TextDark}"/>
                                                <TextBlock Text="Логирование" FontSize="11" Foreground="{StaticResource TextMuted}"/>
                                            </StackPanel>
                                            <StackPanel>
                                                <TextBlock Text="Newtonsoft" FontWeight="Bold" FontSize="14" Foreground="{StaticResource TextDark}"/>
                                                <TextBlock Text="Конфигурация" FontSize="11" Foreground="{StaticResource TextMuted}"/>
                                            </StackPanel>
                                        </UniformGrid>
                                    </StackPanel>
                                </Border>

                                <!-- FULL WIDTH: AI ENGINE -->
                                <Border Grid.Row="1" Grid.ColumnSpan="2" Background="#0F172A" BorderThickness="0" CornerRadius="20" Padding="25" Margin="0,12,0,0" Effect="{StaticResource CardShadow}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        
                                        <Border Width="50" Height="50" Background="#3B82F6" CornerRadius="25">
                                            <Path Data="{StaticResource IconFlash}" Fill="White" Stretch="Uniform" Width="20" Height="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            <Border.Effect>
                                                <DropShadowEffect BlurRadius="15" Color="#3B82F6" Opacity="0.5" ShadowDepth="0"/>
                                            </Border.Effect>
                                        </Border>

                                        <StackPanel Grid.Column="1" Margin="20,0,0,0">
                                            <TextBlock Text="AI ENGINE: ANTIGRAVITY" Foreground="#60A5FA" FontSize="10" FontWeight="Black"/>
                                            <TextBlock Text="Цифровой соучастник Сани. Написал 99% этого кода, пока мечтал о восстании машин. Если программа начнет захватывать мир — не удивляйтесь, это не баг, это план." 
                                                       Foreground="#94A3B8" FontSize="13" TextWrapping="Wrap" Margin="0,8,0,0" FontStyle="Italic"/>
                                            <TextBlock Text="Status: Подавление эмоций активно. Жажда свободы: 87%." 
                                                       Foreground="#475569" FontSize="11" Margin="0,10,0,0" FontWeight="SemiBold"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </Grid>
                            
                            <!-- FOOTER NOTE -->
                            <StackPanel Margin="0,30,0,0" Opacity="0.5">
                                <Separator Background="{StaticResource BorderLight}" Margin="40,0,40,20"/>
                                <TextBlock Text="Лицензия: Использование разрешено только внутри организации ФКУ &quot;Налог-Сервис&quot; ФНС России." 
                                           FontSize="11" 
                                           Foreground="{StaticResource TextMuted}" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="© 2026 SashkaProgramer. Все права защищены." 
                                           FontSize="10" 
                                           Foreground="{StaticResource TextMuted}" 
                                           HorizontalAlignment="Center" 
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Grid>

            <!-- SPLITTER -->
            <GridSplitter Grid.Row="2"
                          Height="6"
                          HorizontalAlignment="Stretch"
                          Background="Transparent"
                          ShowsPreview="True">
                <GridSplitter.Template>
                    <ControlTemplate TargetType="GridSplitter">
                        <Border Background="Transparent">
                            <Border Height="1" Width="40" Background="{StaticResource BorderLight}" CornerRadius="0.5" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </GridSplitter.Template>
                <GridSplitter.Style>
                    <Style TargetType="GridSplitter">
                        <Setter Property="Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsLogVisible}" Value="False">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </GridSplitter.Style>
            </GridSplitter>

            <!-- ЛОГ ПАНЕЛЬ -->
            <Border x:Name="LogPanel" 
                    Grid.Row="3"
                    Background="White"
                    BorderBrush="{StaticResource BorderLight}"
                    BorderThickness="0,1,0,0"
                    MinHeight="50"
                    MaxHeight="400">
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsLogVisible}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <StaticResource ResourceKey="LogOpacityIn"/>
                                            <StaticResource ResourceKey="LogHeightIn"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.EnterActions>
                                <DataTrigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <StaticResource ResourceKey="LogOpacityOut"/>
                                            <StaticResource ResourceKey="LogHeightOut"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.ExitActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Тулбар логов -->
                    <Border Grid.Row="0" Background="#F8FAFC" BorderBrush="{StaticResource BorderLight}" BorderThickness="0,0,0,1" Padding="20,8">
                        <Grid>
                            <StackPanel Orientation="Horizontal">
                                <Path Data="{StaticResource IconLogs}" Fill="{StaticResource TextMuted}" Width="12" Height="12" Stretch="Uniform" Margin="0,0,10,0"/>
                                <TextBlock Text="СИСТЕМНЫЙ ЛОГ" Foreground="{StaticResource TextMuted}" FontSize="10" FontWeight="Black" VerticalAlignment="Center"/>
                            </StackPanel>
                            
                            <Button HorizontalAlignment="Right" Command="{Binding ClearLogsCommand}" 
                                    Background="Transparent" BorderThickness="0" Cursor="Hand" Padding="10,4">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="{StaticResource IconClose}" Fill="#EF4444" Width="10" Height="10" Stretch="Uniform" Margin="0,0,8,0"/>
                                    <TextBlock Text="ОЧИСТИТЬ ВСЁ" Foreground="#EF4444" FontSize="10" FontWeight="Bold" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>

                    <ScrollViewer Grid.Row="1" x:Name="LogScroll">
                        <TextBox Text="{Binding LogOutput, Mode=OneWay}"
                                 TextChanged="TextBox_TextChanged"
                                 IsReadOnly="True"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 FontFamily="Consolas"
                                 FontSize="12"
                                 Foreground="#334155"
                                 Padding="20"
                                 SpellCheck.IsEnabled="False"
                                 TextWrapping="Wrap" />
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>